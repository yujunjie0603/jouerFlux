tags:
  - Rules
summary: "Create a new rule for a specific policy"
parameters:
  - in: path
    name: policy_id
    type: integer
    required: true
    description: "The ID of the policy to create a rule for"
  - in: body
    name: rule
    required: true
    schema:
      $ref: "#/definitions/RuleInput"
    description: |
      The rule object to create.
      Rule payload.
      - `action`: ALLOW | DENY
      - `protocol`: TCP | UDP | ICMP | GRE | ESP | AH | ALL
      - `source_ip` / `destination_ip`: IPv4 or IPv6
      - `source_port` : 0â€“65535; required only for TCP/UDP, must be null for other protocols
responses:
  201:
    description: "Created"
    schema:
      $ref: "#/definitions/Rule"
  400:
    description: "Bad Request"
  404:
    description: "Not Found"
